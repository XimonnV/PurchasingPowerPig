<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purchasing Power Pig</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="start-state">
    <!-- Banner image at top center -->
    <div class="banner-container scaled-element">
        <img src="ppp-banner.png" alt="Purchasing Power Pig Banner">
    </div>
    
    <!-- Start state overlay (50% black) -->
    <div class="start-overlay" id="startOverlay"></div>
    
    <!-- Pig image container -->
    <div class="pig-container scaled-element">
        <img src="piggy.png" alt="Piggy Bank">
    </div>
    
    <!-- Banker image container -->
    <div class="banker-container scaled-element">
        <img src="banker.png" alt="Banker">
    </div>
    
    <!-- Banker's mug container -->
    <div class="banker-mug-container scaled-element">
        <div class="banker-mug-fill"></div>
    </div>
    
    <!-- Invisible oval container for drop fill effect -->
    <div class="pig-oval-container scaled-element">
        <div class="pig-oval-fill"></div>
    </div>
    
    <!-- Percentage display centered on pig -->
    <div class="pig-percentage scaled-element" id="pigPercentageDisplay">0%</div>
    
    <!-- Panel container for right-side panels with automatic spacing -->
    <div class="panel-container">
        <div class="controls">
            <div class="control-group">
                <label>Monthly Savings: $<span id="savingsValue">100</span></label>
                <div class="slider-row">
                    <input type="range" id="savings" min="0" max="1000" value="100" step="10">
                    <button id="balanceSavings" class="balance-button" aria-label="Balance"></button>
                </div>
            </div>
            
            <div class="control-group">
                <label>Starting Amount: $<span id="startAmountValue">50000</span></label>
                <div class="slider-row">
                    <input type="range" id="startAmount" min="0" max="100000" value="50000" step="1000">
                    <button id="balanceStartAmount" class="balance-button" aria-label="Balance"></button>
                </div>
            </div>
            
            <div class="control-group">
                <label class="label-deemphasized"><i>Purchasing Power loss</i></label>
                <label>Debasement + CPI: <span id="inflationValue">7</span>%</label>
                <div class="slider-row">
                    <input type="range" id="inflation" min="5" max="20" value="7" step="0.1">
                    <button id="balanceInflation" class="balance-button" aria-label="Balance"></button>
                </div>
            </div>
            
            <div class="control-group">
                <button id="restartButton">Restart</button>
                <button id="pauseButton">Pause</button>
            </div>
        </div>

        <!-- Savings display panel -->
        <div class="savings-display">
            <div class="savings-label">Month: <span id="currentDateValue">2025 October</span></div>
            <div class="savings-label">Savings: <span id="totalSavingsValue">$0</span></div>
            <div class="savings-label">PP: <span id="ppValueFormatted">$(2025-Oct)0</span></div>
            <div class="savings-label">PP Lost: <span id="totalBankValue">0%</span></div>
        </div>

        <!-- Info panel -->
        <div class="info-display">
            <div class="info-text">A full pig equals the purchasing power of $100K at 2025 October</div>
        </div>
    </div>

    <!-- Debug display (hidden by default - remove style="display:none" to show) -->
    <div class="debug-display" style="display: none;">
        Pig: <span id="debugFillValue">0.00</span>%<br>
        Mug: <span id="debugMugValue">0.00</span>%<br>
        Bank $: <span id="debugBankDollars">$0</span>
    </div>

    <!-- Load JavaScript modules in dependency order -->
    <!-- 1. CONFIG - must load first -->
    <script src="config.js"></script>
    
    <!-- 2. Financial Math - uses CONFIG -->
    <script src="financial-math.js"></script>
    
    <!-- 3. DOM Cache - uses CONFIG -->
    <script src="dom-cache.js"></script>
    
    <!-- 4. State Manager - uses CONFIG, settingsCache, and financial-math functions -->
    <script src="state-manager.js"></script>
    
    <!-- 5. Viewport Manager - uses CONFIG and state-manager -->
    <script src="viewport-manager.js"></script>
    
    <!-- 6. Display Layer - handles all visual updates -->
    <script src="liquid-display-handler.js"></script>
    <script src="savings-display-handler.js"></script>
    <script src="date-display-handler.js"></script>
    <script src="ui-display-handler.js"></script>
    <script src="display-manager.js"></script>
    
    <!-- 7. Effect Manager - handles visual effects (ripples, etc.) -->
    <script src="effect-manager.js"></script>
    
    <!-- 8. UI Controllers - handle user interactions -->
    <script src="balance-controller.js"></script>
    <script src="start-state-controller.js"></script>
    
    <!-- 9. Initialization - wire controllers together -->
    <script>
        // Initialize controllers when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            // Create controller instances
            const balanceController = new BalanceController(CONFIG, stateManager);
            const startStateController = new StartStateController(CONFIG, stateManager);
            
            // Initialize controllers
            balanceController.initialize();
            startStateController.initialize();
            
            // Expose for debugging/external access if needed
            window.balanceController = balanceController;
            window.startStateController = startStateController;
        });
    </script>
    
    <!-- 10. Animation Logic - uses all above modules -->
    <script src="ppl-animation.js"></script>
</body>
</html>
