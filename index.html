<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purchasing Power Pig</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Banner image at top center -->
    <div class="banner-container scaled-element">
        <img src="ppp-banner.png" alt="Purchasing Power Pig Banner">
    </div>
    
    <!-- Pig image container -->
    <div class="pig-container scaled-element">
        <img src="piggy.png" alt="Piggy Bank">
    </div>
    
    <!-- Banker image container -->
    <div class="banker-container scaled-element">
        <img src="banker.png" alt="Banker">
    </div>
    
    <!-- Banker's mug container -->
    <div class="banker-mug-container scaled-element">
        <div class="banker-mug-fill"></div>
    </div>
    
    <!-- Invisible oval container for drop fill effect -->
    <div class="pig-oval-container scaled-element">
        <div class="pig-oval-fill"></div>
    </div>
    
    <!-- Panel container for right-side panels with automatic spacing -->
    <div class="panel-container">
        <div class="controls">
            <div class="control-group">
                <label>Starting Amount: $<span id="startAmountValue">50000</span></label>
                <div class="slider-row">
                    <input type="range" id="startAmount" min="0" max="100000" value="50000" step="1000">
                    <button id="balanceStartAmount" class="balance-button" aria-label="Balance"></button>
                </div>
            </div>
            
            <div class="control-group">
                <label class="label-deemphasized"><i>Purchasing Power loss</i></label>
                <label>Debasement + CPI: <span id="inflationValue">7</span>%</label>
                <div class="slider-row">
                    <input type="range" id="inflation" min="5" max="20" value="7" step="0.1">
                    <button id="balanceInflation" class="balance-button" aria-label="Balance"></button>
                </div>
            </div>
            
            <div class="control-group">
                <label>Monthly Savings: $<span id="savingsValue">100</span></label>
                <div class="slider-row">
                    <input type="range" id="savings" min="0" max="1000" value="100" step="10">
                    <button id="balanceSavings" class="balance-button" aria-label="Balance"></button>
                </div>
            </div>
            
            <div class="control-group">
                <button id="restartButton">Restart</button>
                <button id="pauseButton">Pause</button>
            </div>
        </div>

        <!-- Savings display panel -->
        <div class="savings-display">
            <div class="savings-label">Savings: <span id="totalSavingsValue">$0</span></div>
            <div class="savings-label">PP Lost: <span id="totalBankValue">0%</span></div>
            <div class="savings-label">Date: <span id="currentDateValue">2025 October</span></div>
        </div>

        <!-- Info panel -->
        <div class="info-display">
            <div class="info-text">A full pig equals the purchasing power of $100K at 2025 October</div>
        </div>
    </div>

    <!-- Debug display -->
    <div class="debug-display">
        Pig: <span id="debugFillValue">0.00</span>%<br>
        <!--Mug: <span id="debugMugValue">0.00</span>% | Bank $: <span id="debugBankDollars">$0</span> -->
        <!--Mug: <span id="debugMugValue">0.00</span>% -->
    </div>

    <script>
        document.getElementById('startAmount').addEventListener('input', (e) => {
            document.getElementById('startAmountValue').textContent = e.target.value;
            if (typeof window.initializeFromStartingAmount === 'function') {
                window.initializeFromStartingAmount();
            }
        });
        
        document.getElementById('inflation').addEventListener('input', (e) => {
            document.getElementById('inflationValue').textContent = e.target.value;
        });
        
        document.getElementById('savings').addEventListener('input', (e) => {
            document.getElementById('savingsValue').textContent = e.target.value;
        });
        
        document.getElementById('restartButton').addEventListener('click', () => {
            if (typeof window.resetPigFill === 'function') {
                window.resetPigFill();
            }
        });
        
        document.getElementById('pauseButton').addEventListener('click', () => {
            if (typeof window.togglePause === 'function') {
                window.togglePause();
            }
        });
        
        // Balance button for Starting Amount - calculates optimal starting amount
        document.getElementById('balanceStartAmount').addEventListener('click', () => {
            const monthlySavings = parseInt(document.getElementById('savings').value);
            const annualInflationPercent = parseFloat(document.getElementById('inflation').value);
            const annualInflation = annualInflationPercent / 100;
            
            let calculatedAmount;
            
            // Handle division by zero (set to max if inflation is 0)
            if (annualInflation === 0) {
                calculatedAmount = 100000;
            } else {
                // Calculate: (monthly savings * 12) / annual inflation
                calculatedAmount = (monthlySavings * 12) / annualInflation;
                // Round to nearest whole number
                calculatedAmount = Math.round(calculatedAmount);
                // Clamp to min/max range
                calculatedAmount = Math.max(0, Math.min(100000, calculatedAmount));
            }
            
            // Set the slider value
            const startAmountSlider = document.getElementById('startAmount');
            startAmountSlider.value = calculatedAmount;
            
            // Trigger input event to update display and reinitialize
            startAmountSlider.dispatchEvent(new Event('input'));
        });
        
        // Balance button for Monthly Savings - calculates optimal monthly savings
        document.getElementById('balanceSavings').addEventListener('click', () => {
            const startingAmount = parseInt(document.getElementById('startAmount').value);
            const annualInflationPercent = parseFloat(document.getElementById('inflation').value);
            const annualInflation = annualInflationPercent / 100;
            
            // Calculate: (starting amount * annual inflation) / 12
            let calculatedSavings = (startingAmount * annualInflation) / 12;
            // Round to nearest whole number
            calculatedSavings = Math.round(calculatedSavings);
            // Clamp to min/max range
            calculatedSavings = Math.max(0, Math.min(1000, calculatedSavings));
            
            // Set the slider value
            const savingsSlider = document.getElementById('savings');
            savingsSlider.value = calculatedSavings;
            
            // Trigger input event to update display
            savingsSlider.dispatchEvent(new Event('input'));
        });
        
        // Balance button for Inflation - calculates optimal inflation rate
        document.getElementById('balanceInflation').addEventListener('click', () => {
            const startingAmount = parseInt(document.getElementById('startAmount').value);
            const monthlySavings = parseInt(document.getElementById('savings').value);
            
            let calculatedInflation;
            
            // Handle division by zero (set to default 7% if starting amount is 0)
            if (startingAmount === 0) {
                calculatedInflation = 7;
            } else {
                // Calculate: (monthly savings * 12) / starting amount * 100 to get percentage
                calculatedInflation = (monthlySavings * 12) / startingAmount * 100;
                // Round to 1 decimal place
                calculatedInflation = Math.round(calculatedInflation * 10) / 10;
                // Clamp to min/max range
                calculatedInflation = Math.max(5, Math.min(20, calculatedInflation));
            }
            
            // Set the slider value
            const inflationSlider = document.getElementById('inflation');
            inflationSlider.value = calculatedInflation;
            
            // Trigger input event to update display
            inflationSlider.dispatchEvent(new Event('input'));
        });
    </script>
    <script src="ppl-animation.js"></script>
</body>
</html>
